{"is_source_file": true, "format": "JavaScript (React component)", "description": "A React component that implements a utility tool for finding and repairing broken image URLs in a database, specifically targeting images stored in a Supabase storage bucket called 'app_images'. The component allows administrators to analyze current image URLs for issues such as malformed URLs or missing files, and automatically repair repairable entries by updating the database with corrected URLs.", "external_files": ["../config/supabaseClient"], "external_methods": ["supabase.from", "supabase.storage", "getImageUrl"], "published": ["ImageRepairTool"], "classes": [], "methods": [{"name": "fetchAllApps", "description": "Fetches all app records from the 'apps' table in the database, retrieving their id, name, and image_url."}, {"name": "analyzeImages", "description": "Analyzes each application's image URL to identify issues such as malformed URLs or missing files in storage, and compiles a list of broken images with reasons and repairability status."}, {"name": "repairImages", "description": "Attempts to fix repairable broken images by updating their URLs in the database with corrected versions, then refetches the app list to reflect updates."}], "calls": ["supabase.from('apps').select('id, name, image_url')", "supabase.storage.from('app_images').list(...)", "getImageUrl('app_images', path)", "supabase.from('apps').update({ image_url: img.newUrl }).eq('id', img.id)"], "search-terms": ["ImageRepairTool", "broken image URLs", "Supabase storage", "React image URL repair", "app_images bucket", "image URL analysis", "automatic URL correction"], "state": 2, "file_id": 52, "knowledge_revision": 224, "git_revision": "d3e2c78b02e1d081abb18a85891422c2b2df5156", "revision_history": [{"134": ""}, {"224": "d3e2c78b02e1d081abb18a85891422c2b2df5156"}], "ctags": [{"_type": "tag", "name": "ImageRepairTool", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^const ImageRepairTool = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "analyzeImages", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          onClick={analyzeImages} $/", "language": "JavaScript", "kind": "field", "scope": "onClick", "scopeKind": "class"}, {"_type": "tag", "name": "analyzeImages", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const analyzeImages = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "analyzing", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          disabled={analyzing || loading || apps.length === 0}$/", "language": "JavaScript", "kind": "field", "scope": "disabled", "scopeKind": "class"}, {"_type": "tag", "name": "broken", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^    const broken = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fetchAllApps", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const fetchAllApps = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fileInStorage", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          const fileInStorage = fileExists.some(f => f.name === fileName);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "fileName", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          const fileName = path.split('\\/').pop();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "img", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^        const img = toRepair[i];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "match", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^            const match = app.image_url.match(\\/app_images\\\\\\/([^?]+)\\/);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "newUrl", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          const newUrl = getImageUrl('app_images', path);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^          let path = null;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "repairImages", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const repairImages = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "results", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^    const results = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setAnalyzing", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [analyzing, setAnalyzing] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setApps", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [apps, setApps] = useState([]);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setBrokenImages", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [brokenImages, setBrokenImages] = useState([]);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setLoading", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [loading, setLoading] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setRepairComplete", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [repairComplete, setRepairComplete] = useState(false);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "setRepairStatus", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^  const [repairStatus, setRepairStatus] = useState(null);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "toRepair", "path": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "pattern": "/^      const toRepair = brokenImages.filter(img => img.repairable);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/appvote-portal-89970-89978/appvote_portal/src/utils/ImageRepairTool.js", "hash": "bf887b6f68c64b81e156731744b471b4", "format-version": 4, "code-base-name": "default", "fields": [{"name": "onClick={analyzeImages}", "scope": "onClick", "scopeKind": "class", "description": "unavailable"}, {"name": "disabled={analyzing || loading || apps.length === 0}", "scope": "disabled", "scopeKind": "class", "description": "unavailable"}, {"name": "let path = null;", "scope": "", "scopeKind": "", "description": "unavailable"}]}